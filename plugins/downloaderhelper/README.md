## 下载器助手：一个解放双手的插件

### 1、简介

作者：hotlcc

主页：[Github](https://github.com/hotlcc) | [Gitee](https://gitee.com/hotlcc)

#### 1.1、功能说明

**三大功能**：

1. **自动做种**：通常在通过IYUU等工具辅种后，下载器中种子校验完毕但不会立即变成做种状态，可以通过本插件定时扫描下载器中“已完成但未做种”的种子并设为做种状态。
1. **站点标签**：如果下载器中种子很多，要想统计各站点的种子数量变得麻烦，可以通过本插件定时（或者通过监听下载添加事件）给种子添加站点标签。
1. **自动删种**：定时删除丢失文件的错误种子，或者通过监听源文件删除事件匹配对应的种子自动删除。

**三条执行路线**：

1. **定时执行**：通过配置【定时执行周期】实现后台定时执行。
1. **事件驱动执行**：通过开启相关监听实现事件驱动执行。
1. **手动执行**：通过【即运行一次】或者【设定/服务/执行】手动执行。

#### 1.2、移植说明

本插件由本人从原 NAStool 版本【[下载器助手](https://gitee.com/hotlcc/nastool-plugin/tree/master/downloader-helper)】移植而来，功能只增不减。

插件移植后未花太多心思测试，目前仅测试了 qBittorrent，理论上 Transmission 也不会有太大问题，但由于 MoviePilot 插件机制较原 NAStool 有很大升级，因而不排除存在潜在BUG，望使用者海涵，有问题提 Issues 即可！

### 2、使用说明

#### 2.1、配置项说明

##### 2.1.1、主配置项

|配置项|说明|
|---|---|
|启用插件|插件后台任务的总开关，这里的“后台任务”指的是“定时任务”和“事件触发任务”，不会影响【立即运行一次】的执行。|
|发送通知|任务执行成功后是否发送通知消息。|
|立即运行一次|保存配置后立即运行一次，不受【启用插件】的管控。|
|监听下载事件|监听到下载添加事件后会触发插件给添加的种子打站点标签。|
|监听源文件事件|监听到源文件删除事件后会触发插件根据文件路径判断该源文件对应的种子下的全部数据文件是否都已删除，若全部数据文件都已删除就删除种子，如果有辅种也会一并删除，同时支持单文件种子、多文件（剧集、原盘）种子。|
|站点名称优先|表示在打站点标签时是否优先以站点名称作为标签，否则会以“域名关键字”作为标签；“域名关键字”指的是二级域名段。|
|定时执行周期|插件定时服务的cron表达式，仅支持5位的，缺省时不注册定时服务。|
|排除种子标签|多个标签通过英文逗号分割，具备配置的任意标签的种子不会进行自动做种、站点标签、自动删种操作。|
|站点标签前缀|站点标签的前缀，缺省时不添加前缀。|
|Tracker映射|站点标签的原理是根据tracker的域名去匹配站点，但是有的PT站的tracker域名和站点域名不一致，导致匹配不到站点，因此需要对这些特殊站点的tracker做映射；每行一个映射，格式是 `tracker域名:站点域名`，tracker域名可以是完整域名或者主域名。|

##### 2.1.2、下载器子任务配置项

|配置项|说明|
|---|---|
|任务开关|该下载器子任务的总开关。|
|自动做种|是否启用自动做种功能，启用后还需要配合【定时周期】才可以在后台定时执行。|
|站点标签|是否启用站点标签功能，启用后还需要配合【定时周期】或者【监听下载事件】才可以在后台定时或者事件驱动执行。|
|自动删种|是否启用自动删种功能，启用后还需要配合【定时周期】或者【监听源文件事件】才可以在后台定时或者事件驱动执行。|

#### 2.2、Q&A

（待补充）
